@code {
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    [Parameter(CaptureUnmatchedValues = true)]
    public IReadOnlyDictionary<string, object> AdditionalAttributes { get; set; } = new Dictionary<string, Object>();

    [Parameter]
    public EventCallback<Tab?> OnTabChanged { get; set; }

    [Parameter]
    public bool Pills { get; set; }

    [Parameter]
    public Size? Size { get; set; }

    [Parameter]
    public Direction Direction { get; set; }

    public async Task AddTab(Tab tab)
    {
        TabCollection.Add(tab);
        tab.IsActive = tab.Active;
        await InvokeAsync(StateHasChanged);
    }

    private async Task SetActiveTab(Tab tab)
    {
        if (tab.IsActive)
        {
            return;
        }

        TabCollection.ForEach(t => t.IsActive = false);
        tab.IsActive = true;

        await OnTabChanged.InvokeAsync(tab);
    }

    private CssBuilder TabsCssClass => new CssBuilder().AddClass(Pills ? "tabbed" : "tabs").AddClass(Size?.ToCssClass());

    private List<Tab> TabCollection { get; } = new();
}

<CascadingValue Value="this">
    @ChildContent
    <div @attributes="AdditionalAttributes">
        @if (Pills)
        {
            <nav class="@TabsCssClass">
                @foreach (var tab in TabCollection)
                {
                    <a @onclick="async () => await SetActiveTab(tab)" class=@(tab.IsActive ? "active" : "")>
                        @tab.Title
                    </a>
                }
            </nav>

        }
        else
        {
            <div class="@TabsCssClass">
                @foreach (var tab in TabCollection)
                {
                    <a @onclick="async () => await SetActiveTab(tab)" class=@(tab.IsActive ? "active" : "")>
                        @tab.Title
                    </a>
                }
            </div>
        }

        @foreach (var tab in TabCollection)
        {
            <div class="@tab.CssClass">
                @tab.Content
            </div>
        }
    </div>
</CascadingValue>