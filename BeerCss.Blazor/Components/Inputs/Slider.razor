@typeparam T
@inherits Microsoft.AspNetCore.Components.Forms.InputNumber<T>

@code {
    [Parameter]
    public Size Size { get; set; } = Size.Tiny;

    [Parameter]
    public Orientation Orientation { get; set; } = Orientation.Horizontal;

    [Parameter]
    public bool Disabled { get; set; }

    [Parameter, EditorRequired]
    public required T Step { get; set; }

    [Parameter, EditorRequired]
    public required T Min { get; set; }

    [Parameter, EditorRequired]
    public required T Max { get; set; }

    [Parameter]
    public bool ShowIndicator { get; set; }

    [Parameter]
    public string? HelpText { get; set; }

    private CssBuilder RealCssClass => new CssBuilder()
    .AddClass("slider")
    .AddClass(CssClass)
    .AddClass(Size.ToCssClass())
    .AddClass(Orientation.ToCssClass())
    .AddClassFromAttributes(AdditionalAttributes);

    private RenderFragment RenderInput() => (builder) => base.BuildRenderTree(builder);

    protected override void OnParametersSet()
    {
        base.OnParametersSet();

        var attributes = this.AdditionalAttributes is not null ? new Dictionary<string, object>(this.AdditionalAttributes) :
        new();
        attributes["type"] = "range";
        attributes["step"] = Step!;
        attributes["min"] = Min!;
        attributes["max"] = Max!;

        if (this.Disabled && attributes.ContainsKey("disabled"))
        {
            attributes.Add("disabled", "disabled");
        }
        else if (!this.Disabled && attributes.ContainsKey("disabled"))
        {
            attributes.Remove("disabled");
        }

        this.AdditionalAttributes = attributes;
    }
}

<div class="field middle-align">
    <label class="@RealCssClass">
        @RenderInput()
        <span></span>
        @if (ShowIndicator)
        {
            <div class="tooltip"></div>
        }
    </label>
    @if (!EditContext.IsValid(this.FieldIdentifier))
    {
        <output class="invalid">@EditContext.GetValidationMessages(this.FieldIdentifier).FirstOrDefault()</output>
    }
    else if (HelpText is not null)
    {
        <output>@HelpText</output>
    }
</div>